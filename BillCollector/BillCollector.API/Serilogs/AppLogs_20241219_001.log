2024-12-19 04:28:02.012 +01:00 [WRN] Microsoft.EntityFrameworkCore.Model.Validation   Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development. 
 2024-12-19 04:28:06.257 +01:00 [INF] Microsoft.EntityFrameworkCore.Database.Command   Executed DbCommand ("310"ms) [Parameters=[""], CommandType='Text', CommandTimeout='1000']"
""SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)" 
 2024-12-19 04:28:07.756 +01:00 [INF] Microsoft.EntityFrameworkCore.Database.Command   Executed DbCommand ("236"ms) [Parameters=[""], CommandType='Text', CommandTimeout='1000']"
""SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)" 
 2024-12-19 04:28:09.424 +01:00 [INF] Microsoft.EntityFrameworkCore.Database.Command   Executed DbCommand ("297"ms) [Parameters=[""], CommandType='Text', CommandTimeout='1000']"
""CREATE TABLE \"__EFMigrationsHistory\" (
    \"MigrationId\" character varying(150) NOT NULL,
    \"ProductVersion\" character varying(32) NOT NULL,
    CONSTRAINT \"PK___EFMigrationsHistory\" PRIMARY KEY (\"MigrationId\")
);" 
 2024-12-19 04:28:12.418 +01:00 [INF] Microsoft.EntityFrameworkCore.Database.Command   Executed DbCommand ("247"ms) [Parameters=[""], CommandType='Text', CommandTimeout='1000']"
""SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)" 
 2024-12-19 04:28:12.661 +01:00 [INF] Microsoft.EntityFrameworkCore.Database.Command   Executed DbCommand ("240"ms) [Parameters=[""], CommandType='Text', CommandTimeout='1000']"
""SELECT \"MigrationId\", \"ProductVersion\"
FROM \"__EFMigrationsHistory\"
ORDER BY \"MigrationId\";" 
 2024-12-19 04:28:12.677 +01:00 [INF] Microsoft.EntityFrameworkCore.Migrations   Applying migration '"20241219030647_initial_migration"'. 
 2024-12-19 04:28:12.983 +01:00 [INF] Microsoft.EntityFrameworkCore.Database.Command   Executed DbCommand ("249"ms) [Parameters=[""], CommandType='Text', CommandTimeout='1000']"
""CREATE TABLE \"Roles\" (
    \"Id\" bigint GENERATED BY DEFAULT AS IDENTITY,
    \"Name\" text NOT NULL,
    \"Description\" text NOT NULL,
    \"CreatedBy\" text NOT NULL,
    \"LastModifiedBy\" text,
    \"CreatedAt\" timestamp with time zone NOT NULL,
    \"LastModifiedAt\" timestamp with time zone,
    \"IsDeleted\" boolean NOT NULL,
    CONSTRAINT \"PK_Roles\" PRIMARY KEY (\"Id\")
);" 
 2024-12-19 04:28:13.226 +01:00 [INF] Microsoft.EntityFrameworkCore.Database.Command   Executed DbCommand ("243"ms) [Parameters=[""], CommandType='Text', CommandTimeout='1000']"
""CREATE TABLE \"Users\" (
    \"Id\" bigint GENERATED BY DEFAULT AS IDENTITY,
    \"Email\" text NOT NULL,
    \"PasswordHash\" text NOT NULL,
    \"FirstName\" text NOT NULL,
    \"LastName\" text NOT NULL,
    \"PhoneNumber\" text NOT NULL,
    \"Status\" text NOT NULL,
    \"EmailVerified\" boolean NOT NULL,
    \"PhoneVerified\" boolean NOT NULL,
    \"TwoFactorEnabled\" boolean NOT NULL,
    \"LastLoginAt\" timestamp with time zone,
    \"FailedLoginAttempts\" integer NOT NULL,
    \"PasswordResetToken\" text,
    \"PasswordResetExpires\" timestamp with time zone,
    \"CreatedBy\" text NOT NULL,
    \"LastModifiedBy\" text,
    \"CreatedAt\" timestamp with time zone NOT NULL,
    \"LastModifiedAt\" timestamp with time zone,
    \"IsDeleted\" boolean NOT NULL,
    CONSTRAINT \"PK_Users\" PRIMARY KEY (\"Id\")
);" 
 2024-12-19 04:28:13.475 +01:00 [INF] Microsoft.EntityFrameworkCore.Database.Command   Executed DbCommand ("249"ms) [Parameters=[""], CommandType='Text', CommandTimeout='1000']"
""CREATE TABLE \"Permissions\" (
    \"Id\" bigint GENERATED BY DEFAULT AS IDENTITY,
    \"RoleId\" bigint NOT NULL,
    \"PermissionName\" text NOT NULL,
    \"CreatedBy\" text NOT NULL,
    \"LastModifiedBy\" text,
    \"CreatedAt\" timestamp with time zone NOT NULL,
    \"LastModifiedAt\" timestamp with time zone,
    \"IsDeleted\" boolean NOT NULL,
    CONSTRAINT \"PK_Permissions\" PRIMARY KEY (\"Id\"),
    CONSTRAINT \"FK_Permissions_Roles_RoleId\" FOREIGN KEY (\"RoleId\") REFERENCES \"Roles\" (\"Id\") ON DELETE CASCADE
);" 
 2024-12-19 04:28:13.723 +01:00 [INF] Microsoft.EntityFrameworkCore.Database.Command   Executed DbCommand ("248"ms) [Parameters=[""], CommandType='Text', CommandTimeout='1000']"
""CREATE TABLE \"UserRoles\" (
    \"Id\" bigint GENERATED BY DEFAULT AS IDENTITY,
    \"UserId\" bigint NOT NULL,
    \"RoleId\" bigint NOT NULL,
    \"CreatedBy\" text NOT NULL,
    \"LastModifiedBy\" text,
    \"CreatedAt\" timestamp with time zone NOT NULL,
    \"LastModifiedAt\" timestamp with time zone,
    \"IsDeleted\" boolean NOT NULL,
    CONSTRAINT \"PK_UserRoles\" PRIMARY KEY (\"Id\"),
    CONSTRAINT \"FK_UserRoles_Roles_RoleId\" FOREIGN KEY (\"RoleId\") REFERENCES \"Roles\" (\"Id\") ON DELETE CASCADE,
    CONSTRAINT \"FK_UserRoles_Users_UserId\" FOREIGN KEY (\"UserId\") REFERENCES \"Users\" (\"Id\") ON DELETE CASCADE
);" 
 2024-12-19 04:28:13.967 +01:00 [INF] Microsoft.EntityFrameworkCore.Database.Command   Executed DbCommand ("243"ms) [Parameters=[""], CommandType='Text', CommandTimeout='1000']"
""CREATE INDEX \"IX_Permissions_RoleId\" ON \"Permissions\" (\"RoleId\");" 
 2024-12-19 04:28:14.208 +01:00 [INF] Microsoft.EntityFrameworkCore.Database.Command   Executed DbCommand ("240"ms) [Parameters=[""], CommandType='Text', CommandTimeout='1000']"
""CREATE UNIQUE INDEX \"IX_UserRoles_RoleId\" ON \"UserRoles\" (\"RoleId\");" 
 2024-12-19 04:28:14.447 +01:00 [INF] Microsoft.EntityFrameworkCore.Database.Command   Executed DbCommand ("239"ms) [Parameters=[""], CommandType='Text', CommandTimeout='1000']"
""CREATE UNIQUE INDEX \"IX_UserRoles_UserId\" ON \"UserRoles\" (\"UserId\");" 
 2024-12-19 04:28:14.685 +01:00 [INF] Microsoft.EntityFrameworkCore.Database.Command   Executed DbCommand ("238"ms) [Parameters=[""], CommandType='Text', CommandTimeout='1000']"
""INSERT INTO \"__EFMigrationsHistory\" (\"MigrationId\", \"ProductVersion\")
VALUES ('20241219030647_initial_migration', '8.0.6');" 
 2024-12-19 04:28:17.496 +01:00 [INF] Microsoft.EntityFrameworkCore.Database.Command   Executed DbCommand ("288"ms) [Parameters=[""], CommandType='Text', CommandTimeout='1000']"
""SELECT CASE WHEN COUNT(*) = 0 THEN FALSE ELSE TRUE END
FROM pg_class AS cls
JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
WHERE
        cls.relkind IN ('r', 'v', 'm', 'f', 'p') AND
        ns.nspname NOT IN ('pg_catalog', 'information_schema') AND
        -- Exclude tables which are members of PG extensions
        NOT EXISTS (
            SELECT 1 FROM pg_depend WHERE
                classid=(
                    SELECT cls.oid
                    FROM pg_class AS cls
                             JOIN pg_namespace AS ns ON ns.oid = cls.relnamespace
                    WHERE relname='pg_class' AND ns.nspname='pg_catalog'
                ) AND
                objid=cls.oid AND
                deptype IN ('e', 'x')
        )" 
 2024-12-19 04:28:18.063 +01:00 [INF] Microsoft.EntityFrameworkCore.Database.Command   Executed DbCommand ("242"ms) [Parameters=[""], CommandType='Text', CommandTimeout='1000']"
""SELECT EXISTS (
    SELECT 1
    FROM \"Roles\" AS r)" 
 2024-12-19 04:28:18.399 +01:00 [ERR] Microsoft.EntityFrameworkCore.Database.Command   Failed executing DbCommand ("19"ms) [Parameters=["@p0='2024-12-19T04:28:18.2889339+01:00' (DbType = DateTime), @p1='SYSTEM' (Nullable = false), @p2='Super Administrator with full system access' (Nullable = false), @p3='False', @p4=NULL (DbType = DateTime), @p5=NULL, @p6='SuperAdmin' (Nullable = false)"], CommandType='Text', CommandTimeout='1000']"
""INSERT INTO \"Roles\" (\"CreatedAt\", \"CreatedBy\", \"Description\", \"IsDeleted\", \"LastModifiedAt\", \"LastModifiedBy\", \"Name\")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6)
RETURNING \"Id\";" 
 2024-12-19 04:28:18.447 +01:00 [ERR] Microsoft.EntityFrameworkCore.Update   An exception occurred in the database while saving changes for context type '"BillCollector.Infrastructure.DbContexts.BillCollectorDbContext"'."
""Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> System.ArgumentException: Cannot write DateTime with Kind=Local to PostgreSQL type 'timestamp with time zone', only UTC is supported. Note that it's not possible to mix DateTimes with different Kinds in an array, range, or multirange. (Parameter 'value')
   at Npgsql.Internal.Converters.DateTimeConverterResolver`1.Get(DateTime value, Nullable`1 expectedPgTypeId, Boolean validateOnly)
   at Npgsql.Internal.Converters.DateTimeConverterResolver.<>c.<CreateResolver>b__0_0(DateTimeConverterResolver`1 resolver, DateTime value, Nullable`1 expectedPgTypeId)
   at Npgsql.Internal.Converters.DateTimeConverterResolver`1.Get(T value, Nullable`1 expectedPgTypeId)
   at Npgsql.Internal.PgConverterResolver`1.GetAsObjectInternal(PgTypeInfo typeInfo, Object value, Nullable`1 expectedPgTypeId)
   at Npgsql.Internal.PgResolverTypeInfo.GetResolutionAsObject(Object value, Nullable`1 expectedPgTypeId)
   at Npgsql.Internal.PgTypeInfo.GetObjectResolution(Object value)
   at Npgsql.NpgsqlParameter.ResolveConverter(PgTypeInfo typeInfo)
   at Npgsql.NpgsqlParameter.ResolveTypeInfo(PgSerializerOptions options)
   at Npgsql.NpgsqlParameterCollection.ProcessParameters(PgSerializerOptions options, Boolean validateValues, CommandType commandType)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)" 
 Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> System.ArgumentException: Cannot write DateTime with Kind=Local to PostgreSQL type 'timestamp with time zone', only UTC is supported. Note that it's not possible to mix DateTimes with different Kinds in an array, range, or multirange. (Parameter 'value')
   at Npgsql.Internal.Converters.DateTimeConverterResolver`1.Get(DateTime value, Nullable`1 expectedPgTypeId, Boolean validateOnly)
   at Npgsql.Internal.Converters.DateTimeConverterResolver.<>c.<CreateResolver>b__0_0(DateTimeConverterResolver`1 resolver, DateTime value, Nullable`1 expectedPgTypeId)
   at Npgsql.Internal.Converters.DateTimeConverterResolver`1.Get(T value, Nullable`1 expectedPgTypeId)
   at Npgsql.Internal.PgConverterResolver`1.GetAsObjectInternal(PgTypeInfo typeInfo, Object value, Nullable`1 expectedPgTypeId)
   at Npgsql.Internal.PgResolverTypeInfo.GetResolutionAsObject(Object value, Nullable`1 expectedPgTypeId)
   at Npgsql.Internal.PgTypeInfo.GetObjectResolution(Object value)
   at Npgsql.NpgsqlParameter.ResolveConverter(PgTypeInfo typeInfo)
   at Npgsql.NpgsqlParameter.ResolveTypeInfo(PgSerializerOptions options)
   at Npgsql.NpgsqlParameterCollection.ProcessParameters(PgSerializerOptions options, Boolean validateValues, CommandType commandType)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
